(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-f21d09de"],{"02f4":function(e,a,t){var i=t("4588"),s=t("be13");e.exports=function(e){return function(a,t){var r,n,o=String(s(a)),l=i(t),c=o.length;return l<0||l>=c?e?"":void 0:(r=o.charCodeAt(l),r<55296||r>56319||l+1===c||(n=o.charCodeAt(l+1))<56320||n>57343?e?o.charAt(l):r:e?o.slice(l,l+2):n-56320+(r-55296<<10)+65536)}}},"0390":function(e,a,t){"use strict";var i=t("02f4")(!0);e.exports=function(e,a,t){return a+(t?i(e,a).length:1)}},"214f":function(e,a,t){"use strict";t("b0c5");var i=t("2aba"),s=t("32e9"),r=t("79e5"),n=t("be13"),o=t("2b4c"),l=t("520a"),c=o("species"),d=!r((function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")})),m=function(){var e=/(?:)/,a=e.exec;e.exec=function(){return a.apply(this,arguments)};var t="ab".split(e);return 2===t.length&&"a"===t[0]&&"b"===t[1]}();e.exports=function(e,a,t){var u=o(e),f=!r((function(){var a={};return a[u]=function(){return 7},7!=""[e](a)})),h=f?!r((function(){var a=!1,t=/a/;return t.exec=function(){return a=!0,null},"split"===e&&(t.constructor={},t.constructor[c]=function(){return t}),t[u](""),!a})):void 0;if(!f||!h||"replace"===e&&!d||"split"===e&&!m){var g=/./[u],p=t(n,u,""[e],(function(e,a,t,i,s){return a.exec===l?f&&!s?{done:!0,value:g.call(a,t,i)}:{done:!0,value:e.call(t,a,i)}:{done:!1}})),b=p[0],v=p[1];i(String.prototype,e,b),s(RegExp.prototype,u,2==a?function(e,a){return v.call(e,this,a)}:function(e){return v.call(e,this)})}}},"520a":function(e,a,t){"use strict";var i=t("0bfb"),s=RegExp.prototype.exec,r=String.prototype.replace,n=s,o="lastIndex",l=function(){var e=/a/,a=/b*/g;return s.call(e,"a"),s.call(a,"a"),0!==e[o]||0!==a[o]}(),c=void 0!==/()??/.exec("")[1],d=l||c;d&&(n=function(e){var a,t,n,d,m=this;return c&&(t=new RegExp("^"+m.source+"$(?!\\s)",i.call(m))),l&&(a=m[o]),n=s.call(m,e),l&&n&&(m[o]=m.global?n.index+n[0].length:a),c&&n&&n.length>1&&r.call(n[0],t,(function(){for(d=1;d<arguments.length-2;d++)void 0===arguments[d]&&(n[d]=void 0)})),n}),e.exports=n},"5df3":function(e,a,t){"use strict";var i=t("02f4")(!0);t("01f9")(String,"String",(function(e){this._t=String(e),this._i=0}),(function(){var e,a=this._t,t=this._i;return t>=a.length?{value:void 0,done:!0}:(e=i(a,t),this._i+=e.length,{value:e,done:!1})}))},"5f1b":function(e,a,t){"use strict";var i=t("23c6"),s=RegExp.prototype.exec;e.exports=function(e,a){var t=e.exec;if("function"===typeof t){var r=t.call(e,a);if("object"!==typeof r)throw new TypeError("RegExp exec method returned something other than an Object or null");return r}if("RegExp"!==i(e))throw new TypeError("RegExp#exec called on incompatible receiver");return s.call(e,a)}},a481:function(e,a,t){"use strict";var i=t("cb7c"),s=t("4bf8"),r=t("9def"),n=t("4588"),o=t("0390"),l=t("5f1b"),c=Math.max,d=Math.min,m=Math.floor,u=/\$([$&`']|\d\d?|<[^>]*>)/g,f=/\$([$&`']|\d\d?)/g,h=function(e){return void 0===e?e:String(e)};t("214f")("replace",2,(function(e,a,t,g){return[function(i,s){var r=e(this),n=void 0==i?void 0:i[a];return void 0!==n?n.call(i,r,s):t.call(String(r),i,s)},function(e,a){var s=g(t,e,this,a);if(s.done)return s.value;var m=i(e),u=String(this),f="function"===typeof a;f||(a=String(a));var b=m.global;if(b){var v=m.unicode;m.lastIndex=0}var P=[];while(1){var y=l(m,u);if(null===y)break;if(P.push(y),!b)break;var x=String(y[0]);""===x&&(m.lastIndex=o(u,r(m.lastIndex),v))}for(var w="",U=0,S=0;S<P.length;S++){y=P[S];for(var k=String(y[0]),_=c(d(n(y.index),u.length),0),C=[],L=1;L<y.length;L++)C.push(h(y[L]));var D=y.groups;if(f){var $=[k].concat(C,_,u);void 0!==D&&$.push(D);var T=String(a.apply(void 0,$))}else T=p(k,u,_,C,D,a);_>=U&&(w+=u.slice(U,_)+T,U=_+k.length)}return w+u.slice(U)}];function p(e,a,i,r,n,o){var l=i+e.length,c=r.length,d=f;return void 0!==n&&(n=s(n),d=u),t.call(o,d,(function(t,s){var o;switch(s.charAt(0)){case"$":return"$";case"&":return e;case"`":return a.slice(0,i);case"'":return a.slice(l);case"<":o=n[s.slice(1,-1)];break;default:var d=+s;if(0===d)return t;if(d>c){var u=m(d/10);return 0===u?t:u<=c?void 0===r[u-1]?s.charAt(1):r[u-1]+s.charAt(1):t}o=r[d-1]}return void 0===o?"":o}))}}))},a888:function(e,a,t){"use strict";t("a481"),t("6762"),t("2fdb");var i={bind:function(e,a,t){var i=e.querySelector(".el-dialog__header"),s=e.querySelector(".el-dialog");i.style.cssText+=";cursor:move;",s.style.cssText+=";top:0px;";var r=function(){return window.document.currentStyle?function(e,a){return e.currentStyle[a]}:function(e,a){return getComputedStyle(e,!1)[a]}}();i.onmousedown=function(e){var a=e.clientX-i.offsetLeft,n=e.clientY-i.offsetTop,o=s.offsetWidth,l=s.offsetHeight,c=document.body.clientWidth,d=document.body.clientHeight,m=s.offsetLeft,u=c-s.offsetLeft-o,f=s.offsetTop,h=d-s.offsetTop-l,g=r(s,"left"),p=r(s,"top");g.includes("%")?(g=+document.body.clientWidth*(+g.replace(/\%/g,"")/100),p=+document.body.clientHeight*(+p.replace(/\%/g,"")/100)):(g=+g.replace(/\px/g,""),p=+p.replace(/\px/g,"")),document.onmousemove=function(e){var i=e.clientX-a,r=e.clientY-n;-i>m?i=-m:i>u&&(i=u),-r>f?r=-f:r>h&&(r=h),s.style.cssText+=";left:".concat(i+g,"px;top:").concat(r+p,"px;"),t.child.$emit("dragDialog")},document.onmouseup=function(e){document.onmousemove=null,document.onmouseup=null}}}},s=function(e){e.directive("el-drag-dialog",i)};window.Vue&&(window["el-drag-dialog"]=i,Vue.use(s)),i.install=s;a["a"]=i},b0c5:function(e,a,t){"use strict";var i=t("520a");t("5ca1")({target:"RegExp",proto:!0,forced:i!==/./.exec},{exec:i})},e5aa:function(e,a,t){"use strict";t.r(a);var i=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",{staticClass:"app-container"},[t("el-container",[t("el-header",{staticClass:"content-header",attrs:{height:"auto"}},[t("div",{staticClass:"content-header-left"},[t("el-button-group",[t("el-button",{staticClass:"filter-item",attrs:{type:"primary",icon:"el-icon-edit"},on:{click:e.handleCreated}},[e._v("新增")])],1)],1),e._v(" "),t("div",{staticClass:"content-header-right"},[t("div",[t("el-select",{staticStyle:{width:"100px","margin-right":"10px"},attrs:{placeholder:"请选择"},on:{change:e.handleStateChange},model:{value:e.requestParams.state,callback:function(a){e.$set(e.requestParams,"state",a)},expression:"requestParams.state"}},e._l(e.stateOptions,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),e._v(" "),t("div",[t("el-input",{attrs:{clearable:"",placeholder:"请输入关键字"},on:{change:e.handleSearch},model:{value:e.requestParams.searchKey,callback:function(a){e.$set(e.requestParams,"searchKey",a)},expression:"requestParams.searchKey"}},[t("i",{staticClass:"el-icon-search el-input__icon content-header-search",attrs:{slot:"suffix"},on:{click:e.handleSearch},slot:"suffix"})])],1)])]),e._v(" "),t("el-main",{staticClass:"content-main"},[t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.tableParams.tableLoading,expression:"tableParams.tableLoading"}],attrs:{"row-key":"rowIdx",height:e.tableParams.tableHeight,data:e.tableParams.tableData,border:"","highlight-current-row":""}},[t("el-table-column",{attrs:{prop:"rowIdx","column-key":"rowIdx",label:"序号",width:"50",align:"center"}}),e._v(" "),t("el-table-column",{attrs:{prop:"rolename","column-key":"rolename",label:"角色名称",width:"180",align:"left","show-overflow-tooltip":""}}),e._v(" "),t("el-table-column",{attrs:{prop:"remark","column-key":"remark",label:"角色说明","min-width":"180",align:"left","show-overflow-tooltip":""}}),e._v(" "),t("el-table-column",{attrs:{prop:"state","column-key":"state",label:"状态",width:"90",align:"center"},scopedSlots:e._u([{key:"default",fn:function(a){var i=a.row;return[t("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949","active-value":0,"inactive-value":1},on:{change:function(a){return e.handleSwitchChange(i)}},model:{value:i.state,callback:function(a){e.$set(i,"state",a)},expression:"row.state"}})]}}])}),e._v(" "),t("el-table-column",{attrs:{prop:"createdtime","column-key":"createdtime",label:"创建时间",width:"180",align:"center"},scopedSlots:e._u([{key:"default",fn:function(a){var i=a.row;return[t("i",{staticClass:"el-icon-time"}),e._v(" "),t("span",[e._v(e._s(i.createdtime))])]}}])}),e._v(" "),t("el-table-column",{attrs:{"column-key":"key",label:"操作",width:"120",align:"center",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{staticStyle:{padding:"0px","margin-left":"2px"},attrs:{icon:"el-icon-edit",type:"text"},on:{click:function(t){return e.handleModify(a.row)}}}),e._v(" "),t("el-button",{staticStyle:{padding:"0px","margin-left":"2px"},attrs:{icon:"el-icon-key",type:"text"},on:{click:function(t){return e.handleModifyPolicies(a.row)}}}),e._v(" "),t("el-button",{staticStyle:{padding:"0px","margin-left":"2px"},attrs:{icon:"el-icon-s-operation",type:"text"},on:{click:function(t){return e.handleModifyUsecases(a.row)}}}),e._v(" "),t("el-button",{staticStyle:{padding:"0px","margin-left":"2px"},attrs:{icon:"el-icon-delete",type:"text"},on:{click:function(t){return e.handleDeleted(a.row)}}})]}}])})],1)],1),e._v(" "),t("el-footer",{staticClass:"content-footer",attrs:{height:"auto"}},[t("el-pagination",{attrs:{"current-page":e.requestParams.pageIndex,"page-size":e.requestParams.pageSize,total:e.tableParams.total,"page-sizes":e.tableParams.pageSizeOptions,layout:e.tableParams.layoutOptions},on:{"update:currentPage":function(a){return e.$set(e.requestParams,"pageIndex",a)},"update:current-page":function(a){return e.$set(e.requestParams,"pageIndex",a)},"update:pageSize":function(a){return e.$set(e.requestParams,"pageSize",a)},"update:page-size":function(a){return e.$set(e.requestParams,"pageSize",a)},"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange,"prev-click":e.handleCurrentChange,"next-click":e.handleCurrentChange}})],1)],1),e._v(" "),t("el-drawer",{attrs:{size:"320px","custom-class":"el-drawer-custom-class","destroy-on-close":"",title:e.editParams.drawerTitle,visible:e.editParams.drawerVisible},on:{"update:visible":function(a){return e.$set(e.editParams,"drawerVisible",a)}}},[t("div",{staticStyle:{display:"flex","flex-direction":"column",height:"100%",padding:"0px 20px"}},[t("div",{staticStyle:{flex:"1"}},[t("el-form",{ref:"roleForm",attrs:{model:e.editParams.form,rules:e.editParams.rules}},[t("el-form-item",{attrs:{label:"角色名称：",prop:"rolename","label-width":e.editParams.formLabelWidth}},[t("el-input",{attrs:{placeholder:"请输入角色名称",autocomplete:"off"},model:{value:e.editParams.form.rolename,callback:function(a){e.$set(e.editParams.form,"rolename",a)},expression:"editParams.form.rolename"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"角色描述：",prop:"remark","label-width":e.editParams.formLabelWidth}},[t("el-input",{attrs:{placeholder:"请输入角色描述",autocomplete:"off"},model:{value:e.editParams.form.remark,callback:function(a){e.$set(e.editParams.form,"remark",a)},expression:"editParams.form.remark"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"状态：",prop:"state","label-width":e.editParams.formLabelWidth}},[t("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949","active-value":0,"inactive-value":1},model:{value:e.editParams.form.state,callback:function(a){e.$set(e.editParams.form,"state",a)},expression:"editParams.form.state"}})],1)],1)],1),e._v(" "),t("div",{staticStyle:{display:"flex",padding:"10px 0"}},[t("el-button",{staticStyle:{flex:"1"},on:{click:function(a){e.editParams.drawerVisible=!1}}},[e._v("取 消")]),e._v(" "),t("el-button",{staticStyle:{flex:"1"},attrs:{type:"primary",loading:e.editParams.submitLoading},on:{click:e.handleSave}},[e._v(e._s(e.editParams.submitLoading?"提交中...":"确 定"))])],1)])]),e._v(" "),t("el-dialog",{directives:[{name:"el-drag-dialog",rawName:"v-el-drag-dialog"}],attrs:{width:"620px","custom-class":"el-dialog-custom-class","destroy-on-close":"",title:e.modifyPoliciesParams.dialogTitle,visible:e.modifyPoliciesParams.dialogVisible},on:{"update:visible":function(a){return e.$set(e.modifyPoliciesParams,"dialogVisible",a)}}},[t("div",{staticStyle:{display:"flex","flex-direction":"column",height:"100%"}},[t("div",{staticStyle:{flex:"1"}},[t("el-transfer",{directives:[{name:"loading",rawName:"v-loading",value:e.modifyPoliciesParams.initLoading,expression:"modifyPoliciesParams.initLoading"}],attrs:{titles:["后台用户列表","角色用户列表"],props:e.modifyPoliciesParams.transferProps,data:e.modifyPoliciesParams.transferData},scopedSlots:e._u([{key:"default",fn:function(a){var i=a.option;return t("span",{},[e._v(e._s(i.nickname)+" - "+e._s(i.username))])}}]),model:{value:e.modifyPoliciesParams.selectedData,callback:function(a){e.$set(e.modifyPoliciesParams,"selectedData",a)},expression:"modifyPoliciesParams.selectedData"}},[e._v(" "),t("el-button",{staticClass:"transfer-footer",staticStyle:{flex:"1",margin:"3px 0 3px 5px",padding:"8px"},attrs:{slot:"right-footer",type:"primary",loading:e.modifyPoliciesParams.submitLoading},on:{click:e.handleSavePolicies},slot:"right-footer"},[e._v(e._s(e.modifyPoliciesParams.submitLoading?"提交中...":"确 定"))])],1)],1)])]),e._v(" "),t("el-dialog",{directives:[{name:"el-drag-dialog",rawName:"v-el-drag-dialog"}],attrs:{width:"700px","custom-class":"el-dialog-custom-class","destroy-on-close":"",title:e.modifyUsecasesParams.dialogTitle,visible:e.modifyUsecasesParams.dialogVisible},on:{"update:visible":function(a){return e.$set(e.modifyUsecasesParams,"dialogVisible",a)}}},[t("div",{staticStyle:{display:"flex","flex-direction":"column",height:"100%",padding:"0px 20px"}},[t("div",{staticStyle:{flex:"1"}},[t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.modifyUsecasesParams.initLoading,expression:"modifyUsecasesParams.initLoading"}],attrs:{"row-key":"id",height:e.modifyUsecasesParams.tableHeight,data:e.modifyUsecasesParams.tableData,"tree-props":e.modifyUsecasesParams.tableProps,"default-expand-all":"",border:"","highlight-current-row":""}},[t("el-table-column",{attrs:{prop:"ModuleTitle","column-key":"ModuleTitle",label:"菜单标题",width:"180",align:"left","show-overflow-tooltip":""}}),e._v(" "),t("el-table-column",{attrs:{prop:"Icon","column-key":"Icon",label:"图标",width:"80",align:"center"},scopedSlots:e._u([{key:"default",fn:function(e){var a=e.row;return[t("svg-icon",{attrs:{"icon-class":a.Icon}})]}}])}),e._v(" "),t("el-table-column",{attrs:{prop:"Usecases","column-key":"Usecases",label:"用例","min-width":"360",align:"left"},scopedSlots:e._u([{key:"header",fn:function(a){var i=a.column;return[t("span",[e._v(e._s(i.label))]),e._v(" "),t("el-checkbox",{staticStyle:{padding:"0px","margin-left":"2px"},on:{change:e.handleSelectAll},model:{value:e.modifyUsecasesParams.isSelectAll,callback:function(a){e.$set(e.modifyUsecasesParams,"isSelectAll",a)},expression:"modifyUsecasesParams.isSelectAll"}})]}},{key:"default",fn:function(a){var i=a.row;return e._l(i.Usecases,(function(a,i){return t("el-checkbox",{key:i,attrs:{checked:a.ischecked,label:a.usecasename},on:{change:e.handleUcChanged},model:{value:a.checked,callback:function(t){e.$set(a,"checked",t)},expression:"item.checked"}})}))}}])})],1)],1),e._v(" "),t("div",{staticStyle:{display:"flex",padding:"10px 0"}},[t("el-button",{staticStyle:{flex:"1"},on:{click:function(a){e.modifyUsecasesParams.dialogVisible=!1}}},[e._v("取 消")]),e._v(" "),t("el-button",{staticStyle:{flex:"1"},attrs:{type:"primary",loading:e.modifyUsecasesParams.submitLoading},on:{click:e.handleSaveUsecases}},[e._v(e._s(e.modifyUsecasesParams.submitLoading?"提交中...":"确 定"))])],1)])])],1)},s=[],r=(t("5df3"),t("ac6a"),t("8593")),n=t("a888"),o={name:"AdminRole",filters:{},components:{},directives:{"el-drag-dialog":n["a"]},props:{},data:function(){return{screenHeight:0,stateOptions:[{value:-1,label:"全部"},{value:0,label:"启用"},{value:1,label:"禁用"}],requestParams:{pageIndex:1,pageSize:10,orderby:"",sort:0,searchKey:"",state:-1},tableParams:{tableLoading:!1,tableHeight:0,tableColumns:[],tableData:[],total:0,layoutOptions:"total, sizes, prev, pager, next, jumper",pageSizeOptions:["10","20","30","50","100","200"],multipleSelection:[]},editParams:{isModify:!1,drawerVisible:!1,drawerTitle:"提示",submitLoading:!1,formLabelWidth:"100px",form:{id:"",rolename:"",remark:"",state:0},rules:{rolename:[{required:!0,message:"角色名称不为空",trigger:"blur"}],remark:[{required:!0,message:"角色描述不为空",trigger:"blur"}],state:[{type:"number",message:"状态不合法",trigger:"blur"}]}},modifyPoliciesParams:{dialogVisible:!1,dialogTitle:"分配用户",submitLoading:!1,initLoading:!1,transferProps:{key:"id",label:"nickname"},transferData:[],selectedData:[],roleid:""},modifyUsecasesParams:{dialogVisible:!1,dialogTitle:"设置用例",submitLoading:!1,initLoading:!1,isSelectAll:!1,tableHeight:500,tableProps:{children:"Children",hasChildren:"hasChildren"},tableTmpData:[],tableData:[],tableUcIds:[],roleid:""}}},computed:{},watch:{},created:function(){},mounted:function(){var e=this;this.$nextTick((function(a){return e.initPage()}));var a=null;window.onresize=function(t){return function(t){a&&(clearTimeout(a),a=null),a=setTimeout((function(a){return e.setPageHeight()}),500)}()}},methods:{initPage:function(){this.setPageHeight(),this.getTableData()},setPageHeight:function(){this.screenHeight=document.body.clientHeight,this.tableParams.tableHeight=this.screenHeight-182},getTableColumns:function(){var e=this;this.tableParams.tableColumns=[{columnName:"rowIdx",columnLabel:"序号",columnWidth:58,align:"center",headerAlign:"center",sortable:!1,fixed:!0,show:!0},{columnName:"state",columnLabel:"状态",columnWidth:80,align:"center",headerAlign:"center",sortable:!1,fixed:!1,show:!0,formatter:function(a,t,i){var s=e.$createElement;return s("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949","active-value":0,"inactive-value":1,value:i,rowid:a.id}})}}]},getSearchParam:function(){var e={};for(var a in this.requestParams)if(this.requestParams.hasOwnProperty(a)){var t=this.requestParams[a];t instanceof Array?!t.length||1===t.length&&-1===t[0]||(e[a]=t):0!==t&&!t||-1===t||""!==t&&(e[a]=t)}return e},getTableData:function(){var e=this;this.tableParams.tableLoading=!0,Object(r["h"])(this.getSearchParam()).then((function(a){var t=[],i=(e.requestParams.pageIndex-1)*e.requestParams.pageSize;a.data.PageData.forEach((function(a,s){a["rowIdx"]=i+ ++s,a["createdtime"]=e.$moment(a["createdtime"]).format("YYYY-MM-DD HH:mm:ss"),t.push(a)})),e.tableParams.tableData=t,e.tableParams.total=a.data.TotalItems,e.tableParams.tableLoading=!1})).catch((function(a){e.$message.error({message:a.message||"请求出错"}),e.tableParams.tableLoading=!1}))},handleSizeChange:function(e){this.requestParams.pageIndex=1,this.requestParams.pageSize=e,this.getTableData()},handleCurrentChange:function(e){this.requestParams.pageIndex=e,this.getTableData()},handleStateChange:function(e){this.requestParams.pageIndex=1,this.getTableData()},handleSearch:function(e){this.requestParams.pageIndex=1,this.getTableData()},handleSwitchChange:function(e){var a=this;Object(r["Q"])(e.id,0===e.state).catch((function(e){a.$message.error({message:e.message||"请求出错"}),a.getTableData()}))},handleCreated:function(){this.editParams.isModify=!1,this.editParams.drawerTitle="新增角色",this.editParams.drawerVisible=!0,this.editParams.form={id:"",rolename:"",remark:"",state:0}},handleModify:function(e){this.editParams.isModify=!0,this.editParams.drawerTitle="修改角色",this.editParams.drawerVisible=!0,this.editParams.form=JSON.parse(JSON.stringify(e))},handleSave:function(){var e=this;this.editParams.submitLoading=!0,this.$refs.roleForm.validate((function(a){if(!a)return e.editParams.submitLoading=!1,!1;Object(r["x"])(e.editParams.form,e.editParams.isModify).then((function(a){e.editParams.drawerVisible=!1,e.editParams.submitLoading=!1,e.getTableData()})).catch((function(a){e.$message.error({message:a.message||"请求出错"}),e.editParams.submitLoading=!1}))}))},handleModifyPolicies:function(e){var a=this;this.modifyPoliciesParams.dialogVisible=!0,this.modifyPoliciesParams.submitLoading=!1,this.modifyPoliciesParams.roleid=e.id,this.modifyPoliciesParams.initLoading=!0,Object(r["d"])(this.modifyPoliciesParams.roleid).then((function(e){a.modifyPoliciesParams.transferData=e.data;var t=[];a.modifyPoliciesParams.transferData.forEach((function(e){!0===e["isexist"]&&t.push(e.id)})),a.modifyPoliciesParams.selectedData=t,a.modifyPoliciesParams.initLoading=!1})).catch((function(e){a.$message.error({message:e.message||"请求出错"}),a.modifyPoliciesParams.initLoading=!1,a.modifyPoliciesParams.dialogVisible=!1}))},handleSavePolicies:function(){var e=this;this.modifyPoliciesParams.selectedData.length<1?this.$message.error({message:"请选择用户"}):(this.modifyPoliciesParams.submitLoading=!0,Object(r["y"])({roleid:this.modifyPoliciesParams.roleid,userids:this.modifyPoliciesParams.selectedData}).then((function(a){e.modifyPoliciesParams.dialogVisible=!1,e.modifyPoliciesParams.submitLoading=!1})).catch((function(a){e.$message.error({message:a.message||"请求出错"}),e.modifyPoliciesParams.submitLoading=!1})))},handleModifyUsecases:function(e){var a=this;this.modifyUsecasesParams.dialogVisible=!0,this.modifyUsecasesParams.submitLoading=!1,this.modifyUsecasesParams.initLoading=!0,this.modifyUsecasesParams.isSelectAll=!1,this.modifyUsecasesParams.tableTmpData=[],this.modifyUsecasesParams.tableData=[],this.modifyUsecasesParams.tableUcIds=[],this.modifyUsecasesParams.roleid=e.id;var t=Object(r["e"])().then((function(e){a.modifyUsecasesParams.tableTmpData=e.data})),i=Object(r["l"])(this.modifyUsecasesParams.roleid).then((function(e){a.modifyUsecasesParams.tableUcIds=e.data.map((function(e){return e.id}))}));Promise.all([t,i]).then((function(){a.setUsecaseChecked(a.modifyUsecasesParams.tableTmpData,a.modifyUsecasesParams.tableUcIds),a.modifyUsecasesParams.isSelectAll=a.setSelectAllFlag(a.modifyUsecasesParams.tableTmpData),a.modifyUsecasesParams.tableData=a.modifyUsecasesParams.tableTmpData,a.modifyUsecasesParams.initLoading=!1})).catch((function(e){a.$message.error({message:e.message||"请求出错"}),a.modifyUsecasesParams.initLoading=!1,a.modifyUsecasesParams.dialogVisible=!1}))},setUsecaseChecked:function(e,a){var t=this;e&&e.forEach((function(e){e.Usecases&&e.Usecases.forEach((function(e){a.indexOf(e.id)>-1?e.ischecked=!0:e.ischecked=!1})),t.setUsecaseChecked(e.Children,a)}))},setSelectAllFlag:function(e){var a=this,t=!0;return e&&e.forEach((function(e){return e.Usecases&&e.Usecases.forEach((function(e){if(!0!==e.ischecked)return t=!1,!0})),!t||(t=a.setSelectAllFlag(e.Children),!t||void 0)})),t},handleSelectAll:function(e){this.modifyUsecasesParams.isSelectAll=e,this.handleUcChecked(this.modifyUsecasesParams.tableData)},handleUcChecked:function(e){var a=this;e&&e.forEach((function(e){e.Usecases&&e.Usecases.forEach((function(e){e.checked=a.modifyUsecasesParams.isSelectAll})),e.Children&&a.handleUcChecked(e.Children)}))},handleUcChanged:function(e){this.modifyUsecasesParams.isSelectAll=!0===e?this.handleUcSelectFlag(this.modifyUsecasesParams.tableData):e},handleUcSelectFlag:function(e){var a=this,t=!0;return e&&e.forEach((function(e){return e.Usecases&&e.Usecases.forEach((function(e){if(!0!==e.checked)return t=!1,!0})),!t||(t=a.handleUcSelectFlag(e.Children),!t||void 0)})),t},getUsecaseChecked:function(e){var a=this;e&&e.forEach((function(e){e.Usecases&&e.Usecases.forEach((function(e){!0===e.checked&&a.modifyUsecasesParams.tableUcIds.push(e.id)})),a.getUsecaseChecked(e.Children)}))},handleSaveUsecases:function(){var e=this;if(this.modifyUsecasesParams.submitLoading=!0,this.modifyUsecasesParams.tableUcIds=[],this.getUsecaseChecked(this.modifyUsecasesParams.tableData),this.modifyUsecasesParams.tableUcIds.length<1)return this.modifyUsecasesParams.submitLoading=!1,void this.$message.error({message:"请选择用例"});Object(r["z"])({roleid:this.modifyUsecasesParams.roleid,ucids:this.modifyUsecasesParams.tableUcIds}).then((function(a){e.modifyUsecasesParams.dialogVisible=!1,e.modifyUsecasesParams.submitLoading=!1})).catch((function(a){e.$message.error({message:a.message||"请求出错"}),e.modifyUsecasesParams.submitLoading=!1}))},handleDeleted:function(e){var a=this;this.$confirm("此操作将永久删除角色, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(r["K"])([e.id]).then((function(e){return a.getTableData()})).catch((function(e){a.$message.error({message:e.message||"请求出错"})}))})).catch((function(){}))}}},l=o,c=t("2877"),d=Object(c["a"])(l,i,s,!1,null,"33668ea9",null);a["default"]=d.exports}}]);